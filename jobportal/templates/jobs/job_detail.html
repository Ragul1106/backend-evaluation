{% extends 'base.html' %}
{% block title %}{{ job.title }} · Job Portal{% endblock %}
{% block content %}
<div class="row">
  <div class="col-md-8">
    <h3>{{ job.title }}</h3>
    <p class="lead">{{ job.company }} — {{ job.location }}</p>
    <p style="white-space: pre-line">{{ job.description }}</p>
  </div>
  <div class="col-md-4">
    {% if user.is_authenticated and user.role == 'applicant' %}
      <a class="btn btn-success w-100 mb-2" href="{% url 'jobs:apply' job.id %}">Apply Now</a>
    {% endif %}

    {% if user.is_authenticated and user == job.poster %}
      <a class="btn btn-outline-primary w-100 mb-2" href="{% url 'jobs:job_update' job.pk %}">Edit Job</a>
      <a class="btn btn-outline-danger w-100" href="{% url 'jobs:job_delete' job.pk %}">Delete Job</a>
    {% endif %}
  </div>
</div>

<hr>
<h5>Applications</h5>
<ul class="list-group">
  {% for a in job.applications.all %}
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <div>
        <strong>{{ a.applicant.username }}</strong>
        <div class="small text-muted">{{ a.created_at|date:'Y-m-d H:i' }}</div>
      </div>
      <span class="badge text-bg-secondary">{{ a.get_status_display }}</span>
      <a class="btn btn-sm btn-outline-secondary" href="{{ a.resume.url }}" target="_blank">Resume</a>
    </li>
  {% empty %}
    <li class="list-group-item text-muted">No applications yet.</li>
  {% endfor %}
</ul>
{% endblock %}
