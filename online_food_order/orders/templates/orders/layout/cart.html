{% extends 'orders/layout/base.html' %}
{% block title %}Cart | FoodOrder{% endblock %}
{% block content %}
<h3>Your Cart</h3>

{% if cart_items %}

  <!-- MOBILE VIEW (VERTICAL STACK) -->
  <div class="d-block d-md-none">
    {% for i in cart_items %}
      <div class="card mb-3 shadow-sm p-3">
        <h6 class="mb-2">{{ i.title }}</h6>
        <p class="mb-1"><strong>Price:</strong> ₹{{ i.price }}</p>
        <p class="mb-1"><strong>Subtotal:</strong> ₹{{ i.subtotal }}</p>

        <div class="d-flex align-items-center gap-2">
          <a class="btn btn-sm btn-outline-secondary" href="{% url 'orders:decrease_qty' i.id %}">−</a>
          <span class="btn btn-sm btn-light disabled">{{ i.qty }}</span>
          <a class="btn btn-sm btn-outline-secondary" href="{% url 'orders:increase_qty' i.id %}">+</a>
        </div>

        <a class="btn btn-sm btn-outline-danger mt-2" href="{% url 'orders:remove_from_cart' i.id %}">Remove</a>
      </div>
    {% endfor %}

    <div class="text-end mt-3">
      <h5>Total: ₹{{ total }}</h5>
      <a href="{% url 'orders:checkout' %}" class="btn btn-success mt-2">Proceed to Checkout</a>
    </div>
  </div>

  <!-- DESKTOP TABLE VIEW -->
  <div class="d-none d-md-block">
    <div class="table-responsive">
      <table class="table align-middle">
        <thead>
          <tr><th>Item</th><th>Qty</th><th>Price</th><th>Subtotal</th><th></th></tr>
        </thead>
        <tbody>
          {% for i in cart_items %}
          <tr>
            <td>{{ i.title }}</td>
            <td>
              <div class="d-flex align-items-center gap-2">
                <a class="btn btn-sm btn-outline-secondary" href="{% url 'orders:decrease_qty' i.id %}">−</a>
                <span class="btn btn-sm btn-light disabled">{{ i.qty }}</span>
                <a class="btn btn-sm btn-outline-secondary" href="{% url 'orders:increase_qty' i.id %}">+</a>
              </div>
            </td>
            <td>₹{{ i.price }}</td>
            <td>₹{{ i.subtotal }}</td>
            <td><a class="btn btn-sm btn-outline-danger" href="{% url 'orders:remove_from_cart' i.id %}">Remove</a></td>
          </tr>
          {% endfor %}
        </tbody>
        <tfoot>
          <tr><th colspan="3" class="text-end">Total</th><th>₹{{ total }}</th><th></th></tr>
        </tfoot>
      </table>
    </div>

    <!-- ✅ Added desktop checkout bar -->
    <div class="d-flex justify-content-end mt-2">
      <a href="{% url 'orders:checkout' %}" class="btn btn-success">Proceed to Checkout</a>
    </div>
  </div>

{% else %}
  <p>Your cart is empty.</p>
  <a href="{% url 'orders:menu' %}" class="btn btn-primary">Browse menu</a>
{% endif %}

{% endblock %}
